<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book with Captura</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        function toggleMenu() {
            document.getElementById("menu").classList.toggle("show");
        }
    </script>
</head>
<body>

    <header>
        <div class="menu-icon" onclick="toggleMenu()">â˜°</div>
        <div class="logo">Captura</a></div>
        <nav id="menu" class="hidden">
            <a href="index.html">Home</a>
            <a href="portfolio.html">Portfolio</a>
            <a href="booking.html">Booking</a>
            <a href="consultation.html">Consultation</a>
            <a href="about.html">About</a>
        </nav>
    </header>

</body>
<body>
<table border="1" id="schedule">
    <tr>
        <th colspan=5><strong>Schedule from available times!</strong></th>
    <tr>
        <th>Monday</th>
        <th>Tuesday</th>
        <th>Wednesday</th>
        <th>Thursday</th>
        <th>Friday</th>
    </tr>
    <tr>
        <td>9</td><td>9</td><td>9</td><td>9</td><td>9</td>
    </tr>
    <tr>
        <td>10</td><td>10</td><td>10</td><td>10</td><td>10</td>
    </tr>
    <tr>
        <td>11</td><td>11</td><td>11</td><td>11</td><td>11</td>
    </tr>
    <tr>
        <td>12</td><td>12</td><td>12</td><td>12</td><td>12</td>
    </tr>
    <tr>
        <td>1</td><td>1</td><td>1</td><td>1</td><td>1</td>
    </tr>
    <tr>
        <td>2</td><td>2</td><td>2</td><td>2</td><td>2</td>
    </tr>
    <tr>
        <td>3</td><td>3</td><td>3</td><td>3</td><td>3</td>
    </tr>
    <tr>
        <td>4</td><td>4</td><td>4</td><td>4</td><td>4</td>
    </tr>
    <tr>
        <td>5</td><td>5</td><td>5</td><td>5</td><td>5</td>
    </tr>

</table>

<style>
    .booked { 
        text-decoration: line-through;
        background-color: lightgray;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const cells = document.querySelectorAll("#schedule td");
    
        // Fetch saved bookings from the server
        fetch("https://*CapturaURL*/bookings")
            .then(response => response.json())
            .then(bookedTimes => {
                cells.forEach(cell => {
                    const timeSlot = `${cell.cellIndex}-${cell.parentNode.rowIndex}`;
                    if (bookedTimes.includes(timeSlot)) {
                        cell.classList.add("booked");
                    }
    
                    cell.addEventListener("click", function() {
                        this.classList.toggle("booked");
    
                        fetch("https://*CapturaURL*/bookings", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ timeSlot })
                        });
                    });
                });
            });
    });
    </script>
</body>
</html>
